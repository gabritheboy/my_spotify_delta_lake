import json
from pyspark.sql.types import StructType


# schema JSON incollato solo qui una volta
_artists_schema_json = '{"fields":[{"metadata":{},"name":"artists","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"external_urls","nullable":true,"type":{"fields":[{"metadata":{},"name":"spotify","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"followers","nullable":true,"type":{"fields":[{"metadata":{},"name":"href","nullable":true,"type":"string"},{"metadata":{},"name":"total","nullable":true,"type":"long"}],"type":"struct"}},{"metadata":{},"name":"genres","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}},{"metadata":{},"name":"href","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"images","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"height","nullable":true,"type":"long"},{"metadata":{},"name":"url","nullable":true,"type":"string"},{"metadata":{},"name":"width","nullable":true,"type":"long"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"popularity","nullable":true,"type":"long"},{"metadata":{},"name":"type","nullable":true,"type":"string"},{"metadata":{},"name":"uri","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}}],"type":"struct"}'

artists_schema = StructType.fromJson(json.loads(_artists_schema_json))


_albums_schema_json = '{"fields":[{"metadata":{},"name":"albums","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"album_type","nullable":true,"type":"string"},{"metadata":{},"name":"artists","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"external_urls","nullable":true,"type":{"fields":[{"metadata":{},"name":"spotify","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"href","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"type","nullable":true,"type":"string"},{"metadata":{},"name":"uri","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"copyrights","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"text","nullable":true,"type":"string"},{"metadata":{},"name":"type","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"external_ids","nullable":true,"type":{"fields":[{"metadata":{},"name":"upc","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"external_urls","nullable":true,"type":{"fields":[{"metadata":{},"name":"spotify","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"genres","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}},{"metadata":{},"name":"href","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"images","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"height","nullable":true,"type":"long"},{"metadata":{},"name":"url","nullable":true,"type":"string"},{"metadata":{},"name":"width","nullable":true,"type":"long"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"is_playable","nullable":true,"type":"boolean"},{"metadata":{},"name":"label","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"popularity","nullable":true,"type":"long"},{"metadata":{},"name":"release_date","nullable":true,"type":"string"},{"metadata":{},"name":"release_date_precision","nullable":true,"type":"string"},{"metadata":{},"name":"total_tracks","nullable":true,"type":"long"},{"metadata":{},"name":"tracks","nullable":true,"type":{"fields":[{"metadata":{},"name":"href","nullable":true,"type":"string"},{"metadata":{},"name":"items","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"artists","nullable":true,"type":{"containsNull":true,"elementType":{"fields":[{"metadata":{},"name":"external_urls","nullable":true,"type":{"fields":[{"metadata":{},"name":"spotify","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"href","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"type","nullable":true,"type":"string"},{"metadata":{},"name":"uri","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"disc_number","nullable":true,"type":"long"},{"metadata":{},"name":"duration_ms","nullable":true,"type":"long"},{"metadata":{},"name":"explicit","nullable":true,"type":"boolean"},{"metadata":{},"name":"external_urls","nullable":true,"type":{"fields":[{"metadata":{},"name":"spotify","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"href","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"is_local","nullable":true,"type":"boolean"},{"metadata":{},"name":"is_playable","nullable":true,"type":"boolean"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"preview_url","nullable":true,"type":"string"},{"metadata":{},"name":"track_number","nullable":true,"type":"long"},{"metadata":{},"name":"type","nullable":true,"type":"string"},{"metadata":{},"name":"uri","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}},{"metadata":{},"name":"limit","nullable":true,"type":"long"},{"metadata":{},"name":"next","nullable":true,"type":"string"},{"metadata":{},"name":"offset","nullable":true,"type":"long"},{"metadata":{},"name":"previous","nullable":true,"type":"string"},{"metadata":{},"name":"total","nullable":true,"type":"long"}],"type":"struct"}},{"metadata":{},"name":"type","nullable":true,"type":"string"},{"metadata":{},"name":"uri","nullable":true,"type":"string"}],"type":"struct"},"type":"array"}}],"type":"struct"}'

albums_schema = StructType.fromJson(json.loads(_albums_schema_json))